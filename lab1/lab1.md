# Метод статистических испытаний (метод Монте-Карло)

Имитационное моделирование представляет собой наблюдение за поведением модели исследуемой системы под влиянием входных воздействий. В результате этого исследователь получает набор экспериментальных данных, на основе которых могут быть оценены характеристики системы. Имитационная модель должна:

- Отражать логику функционирования исследуемой системы во времени;
- Обеспечивать возможность проведения статистического эксперимента.

Суть рассматриваемого метода состоит в том, что результат имитационного эксперимента (статистического испытания) ставится в зависимость от значения некоторой случайной величины, распределенной по заданному закону. Поэтому результат каждого отдельного испытания также носит случайный характер.

Проведя серию испытаний, получают множество частных значений наблюдаемой характеристики (то есть выборку). Полученные статистические данные обрабатываются и представляются в виде соответствующих численных оценок интересующих исследователя величин (характеристик системы).

Важно отметить, что метод статистических испытаний применим для исследования как стохастических, так и детерминированных систем.

Еще одной важной особенностью данного метода является то, что его реализация практически невозможна без использования компьютера.

Рассмотрим применение метода статистических испытаний для вычисления площади круга заданного радиуса. Данная задача явно относится к классу детерминированных, поскольку весьма сложно представить себе случайные факторы, под влиянием которых площадь неподвижной геометрической фигуры могла бы изменяться. 

Пусть круг имеет радиус r = 5, и его центр находится в точке с координатами (1;2). Уравнение соответствующей окружности имеет вид:

$$
(x - 1)^2 + (y - 2)^2 = 25
$$

Для решения задачи методом Монте-Карло впишем круг в квадрат. Его вершины будут иметь координаты (-4,-3), (6,-3), (-4,7) и (6,7). Любая точка внутри квадрата или на его границе должна удовлетворять неравенствам

$$
-4 < x < 6 \quad \text{и} \quad -3 < y < 7.
$$

При решении данной задачи естественно исходить из того, что все точки в этом квадрате могут появляться с одинаковой вероятностью, то есть х и у распределены равномерно с плотностями вероятности:

$$
f(x) =
\begin{cases}
\text{1/10}, & \text{для } -4 \leq x \leq 6 \\
0, & \text{в противном случае}
\end{cases}
$$

$$
f(y) =
\begin{cases}
\text{1/10}, & \text{для } -3 \leq y \leq 7 \\
0, & \text{в противном случае}
\end{cases}
$$    

Проведя некоторое количество испытаний (т.е. получив множество случайных точек, принадлежащих квадрату), подсчитываем число точек, попавших внутрь круга или на окружность. Если выборка состоит из n наблюдений и m из n точек попали внутрь круга или на окружность, то вероятность попадания в круг можно найти из соотношения

$$
P = \frac{m}{n}.
$$

C другой стороны, геометрическая интерпретация вероятности выражается соотношением 

$$
P = \frac{S_{\text{кр}}}{S_{\text{кв}}}.
$$

Приравнивая эти выражения, получим оценку площади круга 

$$
S_{\text{кр}} = S_{\text{кв}} \cdot \frac{m}{n} = 100 \cdot \frac{m}{n}.
$$

В таблице приведены оценки S<sub>кр</sub>, полученные для разных значений n, причем для каждого n выполнялось 5 прогонов (точное значение S<sub>кр</sub> = 78,54 см):


### Результаты оценки площади круга методом статических испытаний

В таблице представлены оценки площади круга S<sub>кр</sub> с соответствующим числом испытаний n.

| Номер прогона | n=100 | n=200  | n=1000 | n=5000 | n=10000|
|---------------|-------|--------|--------|--------|--------|
| 1             | 78    | 79,5   | 77     | 79,5   | 77     |
| 2             | 70    | 77     | 78     | 81,88  | 78,8   |
| 3             | 81    | 77,3   | 80,2   | 79,5   | 79,8   |
| 4             | 70    | 79,12  | 71,29  | 78,22  | 78,6   |
| 5             | 79    | 77,72  | 77,76  | 79     | 78,26  |
| **Среднее**   | 75,6  | 78,13  | 76,85  | 79,62  | 78,49  |
| **Дисперсия** | 27,3  | 1,24   | 11,07  | 1,87   | 1,02   |

Прогоны отличаются друг от друга последовательностями случайных чисел, из которых формировались координаты точек.

На основании полученных результатов могут быть сделаны выводы, которые справедливы для любого имитационного эксперимента независимо от физической природы и типа моделируемой системы:

- Каждый прогон модели можно рассматривать как одно наблюдение в проводимом эксперименте на модели.
- С увеличением продолжительности прогона (то есть продолжительности наблюдения) отклонение измеряемой величины от ее точного значения уменьшается, поскольку наблюдаемая система переходит в стационарное состояние.
- Существует предел, за которым увеличение продолжительности прогона модели уже не дает существенного повышения точности результата, измеряемой дисперсией.

## Задание к лабораторной работе

Написать программу вычисления площади круга методом Монте-Карло. Радиус и координаты центра круга задаются преподавателем. Выполнить 5 прогонов по 100, 500, 1000 и 10000 испытаний. Результаты экспериментов занести в таблицу. 
Для получения координат очередной точки использовать генераторы случайных чисел на отрезке ( 0 ; 1 ).
Если необходимо получить случайное число на отрезке ( a ; b ), то  следует выполнить преобразование:
$$
R = a + (b - a) \cdot r,
$$
где r — случайное число на отрезке ( 0 ; 1 ), R — случайное число на отрезке ( a ; b ).

### Программа оптимизирована для кодировки UTF-8 и адаптирована для C++ Builder 12